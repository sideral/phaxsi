Phaxsi={};Phaxsi.Module={};Phaxsi.Util={url:function(a){return Phaxsi.path.base+a},localizedUrl:function(a){return Phaxsi.path.local+a},publicUrl:function(a){return Phaxsi.path["public"]+a},trim:function(a){return a.replace(/^\s+|\s+$/g,"")},jsonToUrl:function(a){var b=[];for(var c in a){b[b.length]=c+"="+a[c]}return b.join("&")}};Phaxsi.Array={search:function(a,b){var c=-1;for(var d=0;d<b.length;d++){if(b[d]==a){c=d;break}}return c},is:function(a){return!!(a&&a.constructor==Array)},flip:function(a){var b={};for(var c=0;c<a.length;c++){b[a[c]]=c}return b},diffKey:function(a,b){var c={};for(var d in a){if(b[d]===undefined){c[d]=a[d]}}return c},diff:function(a,b){var c={};for(var d in a){if(Phaxsi.Array.search(d,b)==-1){c[d]=a[d]}}return c},clean:function(a,b){var c=new Array;for(var d=0;d<a.length;d++){if(a[d]!=b){c.push(a[d])}}return c},unique:function(a){var b="",c=[],d="";var e=function(a,b){var c="";for(c in b){if(b.hasOwnProperty(c)){if(b[c]+""===a+""){return c}}}return false};for(b in a){if(a.hasOwnProperty(b)){d=a[b];if(false===e(d,c)){c[b]=d}}}return c}};Phaxsi.Validator={};Phaxsi.Validator.List={};Phaxsi.Validator.Current=null;Phaxsi.Validator.DefaultErrorMessages={};Phaxsi.Validator.Manager=function(a,b){this.init(a,b)};Phaxsi.Validator.Manager.prototype={validators:null,id:"",form:null,init:function(a){this.id=a;this.form=document.getElementById(this.id);this.validators=new Object},attachToSubmit:function(){Phaxsi.Event.addEvent(this.form,"submit",this.validate.createDelegate(this))},validate:function(a){var b=[];var c=Phaxsi.serialize(this.form);var d=c.split("&");for(var e=0;e<d.length;e++){var f=d[e].split("=");var g=decodeURIComponent(f[0]);var h=g.match(/(.+?)\[(.+?)\]$/);if(h){if(b[h[1]]===undefined)b[h[1]]=[];b[h[1]][h[2]]=decodeURIComponent(f[1])}else{b[g]=decodeURIComponent(f[1])}}var i=new Phaxsi.Validator.Error;var j=true;for(var g in this.validators){var k=this.validators[g].validate(b[g]);if(k!=""){i.show(g,k,this.id);j=false}else{i.hide(g,this.id)}}if(!j){a.preventDefault()}},addValidator:function(a,b,c,d){this.validators[a]=new Phaxsi.Validator.Instance(b,c,d)}};Phaxsi.Validator.Error=function(){return{show:function(a,b,c){var d=document.getElementById("error-message-"+a);if(!d)return;d.innerHTML=b;d.style.display=""},hide:function(a,b){var c=document.getElementById("error-message-"+a);if(!c)return;c.style.display="none"}}};Phaxsi.Validator.Instance=function(options,messages,config){return{validate:function(value){if(config&&config.array){if(value&&!Phaxsi.Array.is(value)){return"generic"}return this.validateArray(value)}if(config&&config.file){return this.validateFile(value)}if(config&&config.trim){value=Phaxsi.Util.trim(value)}if(config.callback){var func=eval(config.callback);if(func(value)==false){return this.getErrorMessage("callback")}}var isNull=Phaxsi.Array.search(value,options["null_values"])!=-1;if(options["required"]&&isNull){return this.getErrorMessage("required")}if(isNull){return""}if(options["expression"]&&!value.match(new RegExp(options["expression"]))){return this.getErrorMessage("expression")}if(options["in"]&&Phaxsi.Array.search(value,options["in"])==-1){return this.getErrorMessage("in")}if(options["max_length"]&&value.length>options["max_length"]){return this.getErrorMessage("max_length")}if(options["min_length"]&&value.length<options["min_length"]){return this.getErrorMessage("min_length")}var floatValue=parseFloat(value);if(options["max_value"]&&floatValue>options["max_value"]){return this.getErrorMessage("max_value")}if(options["min_value"]&&floatValue<options["min_value"]){return this.getErrorMessage("min_value")}return""},validateArray:function(a){if(a===undefined)a=[];var b=0;for(var c=0;c<a.length;c++){if(Phaxsi.Array.search(a[c],options["null_values"])!=-1){b++}}if(options["required"]&&(b!==0||a.length===0)){return this.getErrorMessage("required")}if(options["array_max_count"]&&a.length-b>options["array_max_count"]){return this.getErrorMessage("array_max_count")}if(options["array_min_count"]&&a.length-b<options["array_min_count"]){return this.getErrorMessage("array_min_count")}if(options["array_required_keys"]){for(var c=0;c<options["array_required_keys"].length;c++){if(a[options["array_required_keys"][c]]===undefined){return this.getErrorMessage("array_required_keys")}}}if(options["array_required_values"]){for(var c=0;c<options["array_required_values"].length;c++){if(Phaxsi.Array.search(options["array_required_values"][c],a)){return this.getErrorMessage("array_required_values")}}}if(options["array_count"]&&a.length!=options["array_count"]){return this.getErrorMessage("array_count")}if(options["array_allow_duplicates"]===false){var d=Phaxsi.Array.clean(a,"");var e=Phaxsi.Array.unique(d);if(e.length!=d.length){return this.getErrorMessage("array_allow_duplicates")}}if(a.length==b){return""}config.array=false;for(var c=0;c<a.length;c++){var f=this.validate(a[c]);if(f!=""){config.array=true;return f}}config.array=true;return""},validateFile:function(a){if(options["required"]&&!a){return this.getErrorMessage("required")}if(options["extension"]&&a){var b=options["extension"].join("|");if(!a.match(new RegExp(".+\\."+b+"$","i"))){return this.getErrorMessage("extension")}}return""},getErrorMessage:function(a){if(messages[a]){return messages[a]}if(Phaxsi.Validator.DefaultErrorMessages[a]){return Phaxsi.Validator.DefaultErrorMessages[a]}return Phaxsi.Validator.DefaultErrorMessages["generic"]}}};Phaxsi.Event={guid:1,addEvent:function(a,b,c){if(a.addEventListener){a.addEventListener(b,c,false)}else{if(!c.$$guid)c.$$guid=this.guid++;if(!a.events)a.events={};var d=a.events[b];if(!d){d=a.events[b]={};if(a["on"+b]){d[0]=a["on"+b]}}d[c.$$guid]=c;a["on"+b]=this.handleEvent}},removeEvent:function(a,b,c){if(a.removeEventListener){a.removeEventListener(b,c,false)}else{if(a.events&&a.events[b]){delete a.events[b][c.$$guid]}}},handleEvent:function(a){var b=true;a=a||this.fixEvent(((this.ownerDocument||this.document||this).parentWindow||window).event);var c=this.events[a.type];for(var d in c){this.$$handleEvent=c[d];if(this.$$handleEvent(a)===false){b=false}}return b},fixEvent:function(a){a.preventDefault=function(){this.returnValue=false};a.stopPropagation=function(){this.cancelBubble=true};return a},onDOMReady:function(a){function b(){if(arguments.callee.done)return;arguments.callee.done=true;a()}if(document.addEventListener){document.addEventListener("DOMContentLoaded",b,false)}(function(){if(/loaded|complete/.test(document.readyState))return b();if(!b.done)setTimeout(arguments.callee,30)})();if(window.addEventListener){window.addEventListener("load",b,false)}else if(window.attachEvent){window.attachEvent("onload",b)}}};Phaxsi.serialize=function(a){var b=[],c=0,d=a.id,e,f,g,h,i,j,k,l,m,n;f=document.getElementById(d);for(j=0,k=f.elements.length;j<k;++j){e=f.elements[j];i=e.disabled;g=e.name;if(g&&!i){g=encodeURIComponent(g)+"=";h=encodeURIComponent(e.value);switch(e.type){case"select-one":if(e.selectedIndex>-1){n=e.options[e.selectedIndex];b[c++]=g+encodeURIComponent(n.attributes.value&&n.attributes.value.specified?n.value:n.text)}break;case"select-multiple":if(e.selectedIndex>-1){for(l=e.selectedIndex,m=e.options.length;l<m;++l){n=e.options[l];if(n.selected){b[c++]=g+encodeURIComponent(n.attributes.value&&n.attributes.value.specified?n.value:n.text)}}}break;case"radio":case"checkbox":if(e.checked){b[c++]=g+h}break;case"file":case undefined:case"reset":case"button":break;case"submit":default:b[c++]=g+h}}}return b.join("&")};Function.prototype.createDelegate=function(a,b,c){var d=this;return function(){var e=b||arguments;if(c===true){e=Array.prototype.slice.call(arguments,0);e=e.concat(b)}else{if(typeof c=="number"){e=Array.prototype.slice.call(arguments,0);var f=[c,0].concat(b);Array.prototype.splice.apply(e,f)}}return d.apply(a||window,e)}}